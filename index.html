<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Jonas Green</title>

    <link href="css/reset.css" rel="stylesheet" type="text/css">
    
</head>
<body>
<script>
    document.addEventListener('keydown', function(event) {
        if (event.code === 'ArrowLeft') {
            previousPhoto();
            replacePhotoElement();
        }
        else if (event.code === 'ArrowRight') {
            nextPhoto();
            replacePhotoElement();
        }
    });

    function photoUrl(photo){
        return "https://farm" + photo.farm + ".staticflickr.com/" + photo.server + "/" + photo.id + "_" + photo.secret + ".jpg";
    }

    function nextPhoto(){
        window.photoIndex = window.photoIndex < (window.photos.length -1) ? window.photoIndex + 1 : 0;
    }

    function previousPhoto(){
        window.photoIndex = window.photoIndex === 0 ? window.photos.length -1 : window.photoIndex -1;
    }

    function replacePhotoElement(){
        let elem = document.getElementById("img");
        let parent = elem.parentNode;
        parent.removeChild(elem);

        elem = document.createElement("img");
        elem.id = "img";
        elem.src = photoUrl(window.photos[window.photoIndex]);
        parent.appendChild(elem);
        elem.style.opacity = "0";
        elem.style.transition = "opacity 250ms";

        requestAnimationFrame(_ => {
            setTimeout(() => elem.style.opacity = "1", 50);
        });


    }

    function jsonFlickrApi(rsp) {
        window.photos = rsp.photoset.photo.reverse();
        window.photoIndex = 0;
        replacePhotoElement();
    }

    function left(event){
        previousPhoto();
        replacePhotoElement();
    }

    function right(event){
        nextPhoto();
        replacePhotoElement();
    }

</script>


<div id="doodle" class="doodle">
    <img id="img" class="img" src="" alt="">
</div>

<div class="navigation navigation-left" onclick="left()">&#8249;</div>
<div class="navigation navigation-right" onclick="right()">&#8250;</div>

<script src="https://api.flickr.com/services/rest/?method=flickr.photosets.getPhotos&api_key=29da47a7c030efd6a30b96cad599a036&photoset_id=72157679203556818&format=json"></script>

</body>
</html>
